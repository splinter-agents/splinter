---
title: Control Layer
description: Safety mechanisms that stop agents before they cause damage
---

# Control Layer

The Control Layer provides hard limits and safety mechanisms. These are enforced by the system, not prompts.

## Why Control?

Agents without control will:
- Spend unlimited money
- Run forever
- Use tools they shouldn't
- Get stuck in loops

## Features

| Feature | What it does |
|---------|--------------|
| [Budget Limits](/control/budget-limits) | Stop at $X spent |
| [Step Limits](/control/step-limits) | Stop at N LLM calls |
| [Time Limits](/control/time-limits) | Stop after N seconds |
| [Memory Limits](/control/memory-limits) | Cap memory usage |
| [Loop Detection](/control/loop-detection) | Detect stuck agents |
| [Tool Access](/control/tool-access) | Per-agent permissions |
| [Rate Limiting](/control/rate-limiting) | Per-agent/tool limits |
| [Circuit Breakers](/control/circuit-breakers) | Global safety triggers |
| [Decision Enforcement](/control/decision-enforcement) | Lock decisions |
| [Retry Strategy](/control/retry-strategy) | Handle failures |
| [Custom Rules](/control/custom-rules) | Your own rules |
| [Rollback](/control/rollback) | Restore state |

## Quick Example

```python
from splinter import Splinter

# All controls built-in
s = Splinter(
    openai_key="sk-...",
    max_budget=1.0,   # Stop at $1
    max_steps=20,     # Stop at 20 calls
)

result = await s.run("helper", "Do something")
```

## Advanced Usage

```python
from splinter import Gateway, ExecutionLimits
from splinter.control import (
    RateLimiter,
    CircuitBreaker,
    DecisionEnforcer,
    RulesEngine,
)

# Create gateway with limits
gateway = Gateway(limits=ExecutionLimits(
    max_budget=5.0,
    max_steps=100,
    max_time_seconds=300,
))

# Add rate limiting
limiter = RateLimiter()
limiter.set_agent_limit("researcher", calls=10, window_seconds=60)

# Add circuit breaker
breaker = CircuitBreaker("llm_api", config=CircuitBreakerConfig(
    failure_threshold=5,
))

# Add decision enforcement
enforcer = DecisionEnforcer(auto_lock=True)

# Add custom rules
rules = RulesEngine()
rules.add_rule(Rule(
    rule_id="budget_guard",
    condition=lambda ctx: ctx.get("remaining_budget", 0) < 1.0,
    action=RuleAction.BLOCK,
))
```
